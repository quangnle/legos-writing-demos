<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lattice Based Cryptography - LWE</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/14.2.1/math.min.js" integrity="sha512-VtnWaMtJXqcmxwDizzsWJOnZdX3Jaf9qlFWXEN4nL1KaoQzyNC+1f8lHFD6qd38cyfMgUeucF+pJCTc2p2SsVw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="style.css">
    <script src="lwe.js"></script>
</head>
<body>

<div class="container">
    <h1>Lattice Based Cryptography</h1>
    <h2>LWE (Learning With Errors) 1-Bit Interactive Demo üîê</h2>

    <p>M√£ h√≥a 1 bit. B·∫°n c√≥ th·ªÉ t·∫°o ng·∫´u nhi√™n ho·∫∑c t·ª± nh·∫≠p c√°c tham s·ªë.</p>
    <p><strong>Th√¥ng ƒëi·ªáp M</strong> ƒë∆∞·ª£c m√£ h√≥a l√† m·ªôt bit ƒë∆°n: {0, 1}.</p>

    <hr>

    <h3>1. B∆∞·ªõc T·∫°o Kh√≥a üîë</h3>
    <div>
        <label for="q_val">Ch·ªçn s·ªë nguy√™n t·ªë q:</label>
        <input type="number" id="q_val" value="97">
    </div>
    <div>
        <label for="n_val">Ch·ªçn s·ªë chi·ªÅu n cho vector b√≠ m·∫≠t s (s·ªë c·ªôt c·ªßa A):</label>
        <input type="number" id="n_val" value="4" onchange="updateCustomInputPlaceholders()">
    </div>
    <div>
        <label for="m_val">Ch·ªçn s·ªë chi·ªÅu m cho vector nhi·ªÖu e (s·ªë h√†ng c·ªßa A):</label>
        <input type="number" id="m_val" value="10" onchange="updateCustomInputPlaceholders()">
    </div>

    <div class="custom-input-toggle">
        <input type="checkbox" id="custom_s_toggle" onchange="toggleCustomInput('s')">
        <label for="custom_s_toggle">T√πy ch·ªânh vector b√≠ m·∫≠t s</label>
        <div id="custom_s_input_area" class="custom-input-area" style="display:none;">
            <label for="custom_s_val">Nh·∫≠p vector s (n x 1):</label>
            <p class="input-note">ƒê·ªãnh d·∫°ng: c√°c s·ªë c√°ch nhau b·∫±ng d·∫•u ph·∫©y (vd: 1,2,3). S·∫Ω ƒë∆∞·ª£c coi l√† vector c·ªôt.</p>
            <textarea id="custom_s_val" placeholder="vd: 23,5,87,12"></textarea>
        </div>
    </div>

    <div class="custom-input-toggle">
        <input type="checkbox" id="custom_A_toggle" onchange="toggleCustomInput('A')">
        <label for="custom_A_toggle">T√πy ch·ªânh ma tr·∫≠n A</label>
        <div id="custom_A_input_area" class="custom-input-area" style="display:none;">
            <label for="custom_A_val">Nh·∫≠p ma tr·∫≠n A (m x n):</label>
            <p class="input-note">ƒê·ªãnh d·∫°ng: c√°c ph·∫ßn t·ª≠ trong h√†ng c√°ch nhau b·∫±ng ',', c√°c h√†ng c√°ch nhau b·∫±ng xu·ªëng h√†ng (&Backslash;n). Vd: 1,2,3;4,5,6</p>
            <textarea id="custom_A_val" placeholder="vd: 10,2,3,4\n5,60,7,8\n... (m h√†ng, n c·ªôt)"></textarea>
        </div>
    </div>

    <div class="custom-input-toggle">
        <input type="checkbox" id="custom_e_toggle" onchange="toggleCustomInput('e')">
        <label for="custom_e_toggle">T√πy ch·ªânh vector nhi·ªÖu e</label>
        <div id="custom_e_input_area" class="custom-input-area" style="display:none;">
            <label for="custom_e_val">Nh·∫≠p vector nhi·ªÖu e (m x 1):</label>
            <p class="input-note">ƒê·ªãnh d·∫°ng: c√°c s·ªë {-1,0,1} c√°ch nhau b·∫±ng d·∫•u ph·∫©y (vd: 0,1,-1). S·∫Ω ƒë∆∞·ª£c coi l√† vector c·ªôt.</p>
            <textarea id="custom_e_val" placeholder="vd: 1,0,-1,1,0,0,-1,1,0,-1"></textarea>
        </div>
    </div>

    <button onclick="generateKeys()">T·∫°o Kh√≥a</button>
    <div id="keyGenError" class="error"></div>

    <div id="keyGenerationOutput" class="output" style="display:none;">
        <h4>K·∫øt qu·∫£ T·∫°o Kh√≥a:</h4>
        <p><strong>Vector b√≠ m·∫≠t s (n x 1):</strong> <span id="secret_s"></span></p>
        <p><strong>Ma tr·∫≠n A (m x n):</strong> <br/> <span id="matrix_A"></span></p>
        <p><strong>Vector nhi·ªÖu e (m x 1):</strong> <span id="vector_e"></span></p>
        <p><strong>Vector b = (A.s + e) mod q (m x 1):</strong> <span id="vector_b"></span></p>
        <p class="success">Kh√≥a c√¥ng khai l√† (A, b). Kh√≥a b√≠ m·∫≠t l√† s.</p>
    </div>

    <hr>

    <h3>2. B∆∞·ªõc M√£ H√≥a ‚úâÔ∏è</h3>
    <p>Ng∆∞·ªùi g·ª≠i ch·ªçn m·ªôt th√¥ng ƒëi·ªáp M v√† m·ªôt vector nh·ªã ph√¢n u.</p>
    <div>
        <label for="message_M">Ch·ªçn th√¥ng ƒëi·ªáp M (0 ho·∫∑c 1):</label>
        <select id="message_M">
            <option value="0">0</option>
            <option value="1">1</option>
        </select>
    </div>

    <div class="custom-input-toggle">
        <input type="checkbox" id="custom_u_toggle" onchange="toggleCustomInput('u')">
        <label for="custom_u_toggle">T√πy ch·ªânh vector u</label>
        <div id="custom_u_input_area" class="custom-input-area" style="display:none;">
            <label for="custom_u_val">Nh·∫≠p vector u (m x 1, c√°c ph·∫ßn t·ª≠ 0 ho·∫∑c 1):</label>
            <p class="input-note">ƒê·ªãnh d·∫°ng: c√°c s·ªë {0,1} c√°ch nhau b·∫±ng d·∫•u ph·∫©y (vd: 0,1,1). S·∫Ω ƒë∆∞·ª£c coi l√† vector c·ªôt.</p>
            <textarea id="custom_u_val" placeholder="vd: 1,0,1,1,0,0,1,1,0,1"></textarea>
        </div>
    </div>

    <button onclick="encryptMessage()" id="encryptBtn" disabled>M√£ H√≥a</button>
    <div id="encryptError" class="error"></div>

    <div id="encryptionOutput" class="output" style="display:none;">
        <h4>K·∫øt qu·∫£ M√£ H√≥a:</h4>
        <p><strong>Vector ng·∫´u nhi√™n/t√πy ch·ªânh u (d·∫°ng c·ªôt, m x 1):</strong> <span id="vector_u_display"></span></p>
        <p><strong>Ciphertext c1 = (u<sup>T</sup> . A) mod q (1 x n):</strong> <span id="cipher_c1"></span></p>
        <p><strong>Ciphertext c2 = (u<sup>T</sup> . b + M * floor(q/2)) mod q (scalar):</strong> <span id="cipher_c2"></span></p>
        <p class="success">B·∫£n m√£ l√† (c1, c2).</p>
    </div>

    <hr>

    <h3>3. B∆∞·ªõc Gi·∫£i M√£ üîì</h3>
    <p>Ng∆∞·ªùi nh·∫≠n s·ª≠ d·ª•ng kh√≥a b√≠ m·∫≠t s ƒë·ªÉ gi·∫£i m√£.</p>
    <button onclick="decryptMessage()" id="decryptBtn" disabled>Gi·∫£i M√£</button>
    <div id="decryptError" class="error"></div>

    <div id="decryptionOutput" class="output" style="display:none;">
        <h4>K·∫øt qu·∫£ Gi·∫£i M√£:</h4>
        <p><strong>Gi√° tr·ªã v = (c2 - c1 . s) mod q:</strong> <span id="value_v"></span></p>
        <p><strong>Th√¥ng ƒëi·ªáp gi·∫£i m√£ ƒë∆∞·ª£c M':</strong> <span id="decrypted_M"></span></p>
        <p id="decryptionStatus"></p>
    </div>
</div>

</body>
</html>